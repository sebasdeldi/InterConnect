<div class='panel-block'>
  <%= form_for action_path, html: {class: "control"}, method: action_type do |f| %>
    <%= render 'shared/error_messages', format: params[:format] %>
    <%= hidden_field_tag :operation_id, params[:id] %>
    <div class="columns">
      <div class="column is-11">
        <div class="field">
          <label class="label">* Operation Type:</label>
          <div class="control has-icons-left">
            <div class="select with-guide">
              <%= select_tag :modality, options_for_select(["FCL - EXW", "LCL"], operation(params[:id]).nil? ? '' : operation(params[:id]).modality), {include_blank: 'SELECT AN OPERATION TYPE', class: "full-select modality"}%>
            </div>
            <div class="icon is-small is-left">
              <i class="fas fa-globe"></i>
            </div>
          </div>
        </div>
      </div>
      <div class="column is-1">
        <br>
        <a class="show-modal operation-type">
          <i class="fas fa-info-circle guide-btn"></i>
        </a>
      </div>
    </div>

    <div class="columns">
      <div class="column is-11">
        <label class="label">* Destination Agent:</label>
        <div class="field is-grouped">
          <div class="control has-icons-left">
            <div class="select ">
              <%= f.select :agent_id, options_for_select(agents.map{|agent| ["#{agent.company_name} <#{agent.email}>", agent.id]}, operation_by_user(params[:id]).nil? ? '' : operation_by_user(params[:id]).agent_id), {include_blank: 'SELECT A DESTINATION AGENT'} ,{class: ''} %>
            </div>
            <div class="icon is-small is-left">
              <i class="fas fa-globe"></i>
            </div>
          </div>
          <p class="control text-joiner"> OR </p>
          <p class="control">
            <a class="button is-link show-modal agent">
              ADD NEW AGENT
            </a>
          </p>
        </div>
      </div>
      <div class="column is-1">
        <br>
        <a class="show-modal destination-agent">
          <i class="fas fa-info-circle guide-btn show-modal"></i>
        </a>
      </div>
    </div>
    
    <div class="columns">
      <div class="column is-11">
        <label class="label">* Shipper:</label>
        <div class="field is-grouped">
          <div class="control has-icons-left">
            <div class="select">
              <%= f.select :shipper_id, options_for_select(shippers.map{|shipper| ["#{shipper.company_name} <#{shipper.email}>", shipper.id]}, operation_by_user(params[:id]).nil? ? '' : operation_by_user(params[:id]).shipper_id), {include_blank: 'SELECT A SHIPPER'} ,{class: ''} %>
            </div>
            <div class="icon is-small is-left">
              <i class="fas fa-globe"></i>
            </div>
          </div>
          <p class="control text-joiner"> OR </p>
          <p class="control">
            <a class="button is-link show-modal shipper">
              ADD NEW SHIPPER
            </a>
          </p>
        </div>
      </div>
      <div class="column is-1">
        <br>
        <a class="show-modal shipper-guide">
          <i class="fas fa-info-circle guide-btn"></i>
        </a>
      </div>
    </div>

    <div class="columns">
      <div class="column is-11">
        <label class="label">* Consignee:</label>
        <div class="field is-grouped">
          <div class="control has-icons-left">
            <div class="select">
              <%= f.select :consignee_id, options_for_select(consignees.map{|consignee| ["#{consignee.company_name} <#{consignee.email}>", consignee.id]}, operation_by_user(params[:id]).nil? ? '' : operation_by_user(params[:id]).consignee_id), {include_blank: 'SELECT A CONSIGNEE'} ,{class: ''} %>
            </div>
            <div class="icon is-small is-left">
              <i class="fas fa-globe"></i>
            </div>
          </div>
          <p class="control text-joiner"> OR </p>
          <p class="control">
            <a class="button is-link show-modal consignee">
              ADD NEW CONSIGNEE
            </a>
          </p>
        </div>
      </div>
      <div class="column is-1">
        <br>
        <a class="show-modal consignee-guide">
          <i class="fas fa-info-circle guide-btn"></i>
        </a>
      </div>
    </div>

    <div class="columns">
      <div class="column is-11">
        <div class="field">
          <label class="label">Agent Reference Number:</label>
          <div class="control has-icons-left">
            <div class=" full-select">
              <%= text_field_tag :agent_reference, operation(params[:id]).nil? ? '' : operation(params[:id]).agent_reference, class: 'input with-guide' %>
            </div>
            <div class="icon is-small is-left">
              <i class="fas fa-globe"></i>
            </div>
          </div>
        </div>
      </div>
      <div class="column is-1">
        <br>
        <a class="show-modal agent-reference">
          <i class="fas fa-info-circle guide-btn"></i>
        </a>
      </div>
    </div>

    <div class="columns">
      <div class="column is-11">
        <div class="field">
          <label class="label">Shipper Reference Number:</label>
          <div class="control has-icons-left">
            <div class=" full-select">
              <%= text_field_tag :shipper_reference, operation(params[:id]).nil? ? '' : operation(params[:id]).shipper_reference, class: 'input with-guide' %>
            </div>
            <div class="icon is-small is-left">
              <i class="fas fa-globe"></i>
            </div>
          </div>
        </div>
      </div>
      <div class="column is-1">
        <br>
        <a class="show-modal shipper-reference">
          <i class="fas fa-info-circle guide-btn"></i>
        </a>
      </div>
    </div>

    <div class="columns">
      <div class="column is-11">
        <div class="field">
          <label class="label">Consignee Reference Number:</label>
          <div class="control has-icons-left">
            <div class=" full-select">
              <%= text_field_tag :consignee_reference, operation(params[:id]).nil? ? '' : operation(params[:id]).consignee_reference, class: 'input with-guide' %>
            </div>
            <div class="icon is-small is-left">
              <i class="fas fa-globe"></i>
            </div>
          </div>
        </div>
      </div>
      <div class="column is-1">
        <br>
        <a class="show-modal consignee-reference">
          <i class="fas fa-info-circle guide-btn"></i>
        </a>
      </div>  
    </div>

    <div class="columns">
      <div class="column is-11">
        <div class="field">
          <label class="label">* Port Of Loading (POL):</label>
          <div class="control has-icons-left">
            <div class=" full-select">
              <%= text_field_tag :pol, operation(params[:id]).nil? ? '' : operation(params[:id]).pol, class: 'input with-guide', id: 'port-loading' %>
            </div>
            <div class="icon is-small is-left">
              <i class="fas fa-globe"></i>
            </div>
          </div>
        </div>
      </div>
      <div class="column is-1">
        <br>
        <a class="show-modal pol">
          <i class="fas fa-info-circle guide-btn"></i>
        </a>
      </div>
    </div>

    <div class="columns">
      <div class="column is-11">
        <div class="field">
          <label class="label">* Port Of Discharge (POD):</label>
          <div class="control has-icons-left">
            <div class=" full-select">
              <%= text_field_tag :pod, operation(params[:id]).nil? ? '' : operation(params[:id]).pod, class: 'input with-guide', id: 'port-discharge' %>
            </div>
            <div class="icon is-small is-left">
              <i class="fas fa-globe"></i>
            </div>
          </div>
        </div>
      </div>
      <div class="column is-1">
        <br>
        <a class="show-modal pod">
          <i class="fas fa-info-circle guide-btn"></i>
        </a>
      </div>
    </div>
    
    <br>
    <div>
      <div class="box card-shadow margin-bottom">

        <div class="columns">
          <div class="column is-11">
            <div class="field">
              <label class="label">* Origin Address:</label>
              <div class="control has-icons-left">
                <div class=" full-select">
                  <%= text_field_tag :origin_address, operation(params[:id]).nil? ? '' : operation(params[:id]).origin_address, class: 'input with-guide' %>
                </div>
                <div class="icon is-small is-left">
                  <i class="fas fa-globe"></i>
                </div>
              </div>
            </div>
          </div>
          <div class="column is-1">
            <br>
            <a class="show-modal origin-address">
              <i class="fas fa-info-circle guide-btn"></i>
            </a>
          </div>
        </div>

        <div class="columns">
          <div class="column is-11">
            <div class="field">
              <label class="label">* Origin City:</label>
              <div class="control has-icons-left">
                <div class=" full-select">
                  <%= text_field_tag :origin_city, operation(params[:id]).nil? ? '' : operation(params[:id]).origin_city, class: 'input with-guide' %>
                </div>
                <div class="icon is-small is-left">
                  <i class="fas fa-globe"></i>
                </div>
              </div>
            </div>
          </div>
          <div class="column is-1">
            <br>
            <a class="show-modal origin-city">
              <i class="fas fa-info-circle guide-btn"></i>
            </a>
          </div>
        </div>

        <div class="columns">
          <div class="column is-11">
            <div class="field">
              <label class="label">* Origin State:</label>
              <div class="control has-icons-left">
                <div class=" full-select">
                  <%= text_field_tag :origin_state, operation(params[:id]).nil? ? '' : operation(params[:id]).origin_state, class: 'input with-guide' %>
                </div>
                <div class="icon is-small is-left">
                  <i class="fas fa-globe"></i>
                </div>
              </div>
            </div>
          </div>
          <div class="column is-1">
            <br>
            <a class="show-modal origin-state">
              <i class="fas fa-info-circle guide-btn"></i>
            </a>
          </div>
        </div>

        <div class="columns">
          <div class="column is-11">
            <div class="field">
              <label class="label">* Origin Zip Code:</label>
              <div class="control has-icons-left">
                <div class=" full-select">
                  <%= text_field_tag :origin_zip_code, operation(params[:id]).nil? ? '' : operation(params[:id]).origin_zip_code, class: 'input with-guide' %>
                </div>
                <div class="icon is-small is-left">
                  <i class="fas fa-globe"></i>
                </div>
              </div>
            </div>
          </div>
          <div class="column is-1">
            <br>
            <a class="show-modal origin-zip">
              <i class="fas fa-info-circle guide-btn"></i>
            </a>
          </div>
        </div>

        <div class="columns">
          <div class="column is-11">
            <div class="field">
              <label class="label">* Origin Country:</label>
              <div class="control has-icons-left">
                <div class=" full-select">
                  <%= text_field_tag :origin_country, operation(params[:id]).nil? ? '' : operation(params[:id]).origin_country, class: 'input with-guide' %>
                </div>
                <div class="icon is-small is-left">
                  <i class="fas fa-globe"></i>
                </div>
              </div>
            </div>
          </div>
          <div class="column is-1">
            <br>
            <a class="show-modal origin-country">
              <i class="fas fa-info-circle guide-btn"></i>
            </a>
          </div>
        </div>
      </div>
    </div>
    <br>

    <div class="columns">
      <div class="column is-11">
        <div class="field">
          <label class="label">Destination:</label>
          <div class="control has-icons-left">
            <div class=" full-select">
              <%= text_field_tag :destination, operation(params[:id]).nil? ? '' : operation(params[:id]).destination, class: 'input with-guide' %>
            </div>
            <div class="icon is-small is-left">
              <i class="fas fa-globe"></i>
            </div>
          </div>
        </div>
      </div>
      <div class="column is-1">
        <br>
        <a class="show-modal destination">
          <i class="fas fa-info-circle guide-btn"></i>
        </a>
      </div>
    </div>

    <br>

    <div class="control">
    	<%= f.button type: 'submit', class: 'button is-success' do %>
        <span><%= action_type == "patch" ? "UPDATE" : "CREATE" %></span>
        <span class="icon is-small">
          <i class="fas fa-check"></i>
        </span>
      <% end %>

      <% if action_type == "patch" %>
        <%= link_to operation_path(params[:id]), class: 'button is-danger' do %>
          <span>CANCEL</span>
          <span class="icon is-small">
            <i class="fas fa-times"></i>
          </span>
        <% end %>
      <% else %>
        <%= link_to authenticated_root_path, class: 'button is-danger' do %>
          <span>CANCEL</span>
          <span class="icon is-small">
            <i class="fas fa-times"></i>
          </span>
        <% end %>
      <% end %> 
    </div>
  <% end %>
</div>


<%= render 'new_user_modal', user_type: 'agent' %>

<%= render 'new_user_modal', user_type: 'shipper' %>

<%= render 'new_user_modal', user_type: 'consignee' %>

<%= render 'guides/new_operation/main_guide' %>

